ALIGN的用法

a应当为2的n次方, 即2, 4, 8, 16, 32, 64, 128, 256, 1024, 2048, 4096..... 

ALIGN(x,a) 是为了使x以a为边界对齐，实现原理是给x加上一个最小的数，使x以a为边界对齐。
举个例子，a = 8, x=0, ALIGN(x,a) 运算结果为0； a = 8, x = 3， 运算结果为8；
          a = 8, x = 11, 运算结果为16。 
          
ALIGN:
x 1544 a 512 ALIGN 2048
x 6958 a 512 ALIGN 7168
x 6713 a 512 ALIGN 7168
x 5842 a 512 ALIGN 6144
x 7237 a 512 ALIGN 7680
x 3147 a 512 ALIGN 3584
x 9921 a 512 ALIGN 10240
x 20 a 512 ALIGN 512
x 1101 a 512 ALIGN 1536
x 6427 a 512 ALIGN 6656

x 1520 a 1024 ALIGN 2048
x 2864 a 1024 ALIGN 3072
x 1913 a 1024 ALIGN 2048
x 5280 a 1024 ALIGN 6144
x 9240 a 1024 ALIGN 10240
x 6331 a 1024 ALIGN 7168
x 8187 a 1024 ALIGN 8192
x 6193 a 1024 ALIGN 7168
x 8752 a 1024 ALIGN 9216
x 8916 a 1024 ALIGN 9216

x 6783 a 2048 ALIGN 8192
x 5010 a 2048 ALIGN 6144
x 6735 a 2048 ALIGN 8192
x 3182 a 2048 ALIGN 4096
x 6908 a 2048 ALIGN 8192
x 2462 a 2048 ALIGN 4096
x 3325 a 2048 ALIGN 4096
x 8379 a 2048 ALIGN 10240
x 7153 a 2048 ALIGN 8192
x 9485 a 2048 ALIGN 10240


ALIGN_DOWN(x,a) 是为了使x以a为边界对齐，实现原理是给减去一个最小的数，使x以a为边界对齐。
举个例子，a = 8, x=0, ALIGN_DOWN(x,a) 运算结果为0； a = 8, x = 3， 运算结果为0；
          a = 8, x = 11, 运算结果为8。 
          
ALIGN_DOWN:
x 6334 a 512 ALIGN_DOWN 6144
x 4843 a 512 ALIGN_DOWN 4608
x 5527 a 512 ALIGN_DOWN 5120
x 8706 a 512 ALIGN_DOWN 8704
x 4284 a 512 ALIGN_DOWN 4096
x 2391 a 512 ALIGN_DOWN 2048
x 3692 a 512 ALIGN_DOWN 3584
x 6069 a 512 ALIGN_DOWN 5632
x 6596 a 512 ALIGN_DOWN 6144
x 2350 a 512 ALIGN_DOWN 2048

x 54 a 1024 ALIGN_DOWN 0
x 941 a 1024 ALIGN_DOWN 0
x 1682 a 1024 ALIGN_DOWN 1024
x 2127 a 1024 ALIGN_DOWN 2048
x 3521 a 1024 ALIGN_DOWN 3072
x 4124 a 1024 ALIGN_DOWN 4096
x 4145 a 1024 ALIGN_DOWN 4096
x 5981 a 1024 ALIGN_DOWN 5120
x 2723 a 1024 ALIGN_DOWN 2048
x 6651 a 1024 ALIGN_DOWN 6144

x 351 a 2048 ALIGN_DOWN 0
x 5589 a 2048 ALIGN_DOWN 4096
x 6462 a 2048 ALIGN_DOWN 6144
x 825 a 2048 ALIGN_DOWN 0
x 2093 a 2048 ALIGN_DOWN 2048
x 1475 a 2048 ALIGN_DOWN 0
x 2145 a 2048 ALIGN_DOWN 2048
x 9023 a 2048 ALIGN_DOWN 8192
x 9276 a 2048 ALIGN_DOWN 8192
x 5086 a 2048 ALIGN_DOWN 4096


PTR_ALIGN(p, a) 是为了使地址p以a为边界对齐

PTR_ALIGN:
x 1710 a 512 PTR_ALIGN 2048
x 3561 a 512 PTR_ALIGN 3584
x 3479 a 512 PTR_ALIGN 3584
x 8243 a 512 PTR_ALIGN 8704
x 5153 a 512 PTR_ALIGN 5632
x 4133 a 512 PTR_ALIGN 4608
x 2882 a 512 PTR_ALIGN 3072
x 1395 a 512 PTR_ALIGN 1536
x 843 a 512 PTR_ALIGN 1024
x 1276 a 512 PTR_ALIGN 1536

x 4166 a 1024 PTR_ALIGN 5120
x 6957 a 1024 PTR_ALIGN 7168
x 6633 a 1024 PTR_ALIGN 7168
x 460 a 1024 PTR_ALIGN 1024
x 9974 a 1024 PTR_ALIGN 10240
x 5779 a 1024 PTR_ALIGN 6144
x 6951 a 1024 PTR_ALIGN 7168
x 8355 a 1024 PTR_ALIGN 9216
x 3167 a 1024 PTR_ALIGN 4096
x 5585 a 1024 PTR_ALIGN 6144

x 9599 a 2048 PTR_ALIGN 10240
x 7019 a 2048 PTR_ALIGN 8192
x 7765 a 2048 PTR_ALIGN 8192
x 1161 a 2048 PTR_ALIGN 2048
x 51 a 2048 PTR_ALIGN 2048
x 3593 a 2048 PTR_ALIGN 4096
x 8680 a 2048 PTR_ALIGN 10240
x 3093 a 2048 PTR_ALIGN 4096
x 7263 a 2048 PTR_ALIGN 8192
x 6391 a 2048 PTR_ALIGN 8192


IS_ALIGNED(x,a) 是判断x和a是否对齐

IS_ALIGNED:
x 512 a 512 IS_ALIGNED 1
x 1024 a 512 IS_ALIGNED 1
x 1536 a 512 IS_ALIGNED 1
x 2048 a 512 IS_ALIGNED 1
x 5525 a 512 IS_ALIGNED 0
x 1670 a 512 IS_ALIGNED 0
x 8042 a 512 IS_ALIGNED 0
x 1967 a 512 IS_ALIGNED 0
x 6483 a 512 IS_ALIGNED 0
x 4737 a 512 IS_ALIGNED 0
x 5646 a 512 IS_ALIGNED 0
x 6600 a 512 IS_ALIGNED 0
x 1353 a 512 IS_ALIGNED 0
x 423 a 512 IS_ALIGNED 0

内核中可以查看
include/linux/kernel.h 